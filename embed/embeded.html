<html>
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <!-- Google Tag Manager -->
    <!-- End Google Tag Manager -->
    <title>IFrame Webook integration example</title>
    <link href="/dist/style.css" rel="stylesheet">

    <style>
        body, html {
        }

        .iframe-container {
            height: 100px;
            display: flex;
            justify-content: center;
        }

        .full-height-iframe {
            width: 702px;
            height: 50%;
            border: none;
        }
    </style>
</head>
<body>
<!-- Google Tag Manager (noscript) -->
<noscript>

</noscript>
<!-- End Google Tag Manager (noscript) -->
<div style=" display: flex; justify-content: center">
    <div style="background-color: lightblue; height: 50px; display: flex; justify-content: center; align-items: center; margin-bottom: 20px; min-width:300px;max-width:400px;align-self: center; border-radius: 10px ">
        Other content before iframe
    </div>
</div>

</div>
<div style=" display: flex; justify-content: center">
    <div style="background-color: lightblue; height: 50px; display: flex; justify-content: center; align-items: center; margin-top: 20px; min-width:300px;max-width:400px;align-self: center; border-radius: 10px ">
        Other content after iframe
    </div>
</div>
<script type="text/javascript">
    window.addEventListener("message", function (event) {
        if (event.data && event.data.name) {
            console.log('event name: ' + event.data.name);
            if (event.data.name == "transacationComplete") {
                console.log('Tracked:', event.data);
            }
        }
    });
    const frameId = 'webookWidgetIframe'
    const iframe = document.getElementById(frameId);

    window.addEventListener('message', function (event) {

        if (event.data && event.data.height) {
            iframe.style.height = event.data.height + 'px';
        }
        if (event.data && event.data.width) {
            iframe.style.width = event.data.width + 'px';
        }
    });

    function getQueryParams() {
        const params = new URLSearchParams(window.location.search);
        return params.toString();
    }

    function propagateQueryParams() {
        let iframeSrc = iframe.src;
        const queryParams = getQueryParams();
        if (queryParams) {
            iframeSrc += (iframeSrc.includes('?') ? '&' : '?') + queryParams;
        }
        iframe.src = iframeSrc;
    }

    propagateQueryParams()
</script>
    <div id="my-widget-container"></div>

<script src="/dist/my-lib.umd.js"></script>
<script>
    MyLib.renderWidget('my-widget-container', { /* props */});
</script>

</body>
</html>
